<div class="container mt-2">

    <!-- Filter details -->
    <form [formGroup]="formgroup" >
    <div class="grid-card-container card-bottom-margin form-bg">
       <div class="grid-form">
            <!-- begin::academic year -->
            <div class="form-group">
                <label class="form-label required">Academic Year</label>
                <mat-select formControlName="academicYearCode" class="form-control form-control-sm">
                    <input type="text" class="form-control  form-control-sm" #filterAcademicYear>
                    <div *ngIf="academicYearList | async as postdata ">
                        <mat-option
                            *ngFor="let data of postdata | filterData: filterAcademicYear.value : 'academicYear'"
                            [value]="data.academicYearCode">
                            {{data.academicYear}}
                        </mat-option>
                    </div>
                </mat-select>
                <div class="invalid-feedback">
                    {{validationMsg.getErrorMessage(feesFormControll.academicYearCode,"Academic Year")}}
                </div>
            </div>
            <!-- end::academic year -->
            <!-- begin::Standard -->
            <div class="form-group">
                <label class="form-label required">Standard</label>
                <!-- <input class="form-control form-control-sm" formControlName="standard" autocomplete="off"> -->
                <mat-select class="form-control form-control-sm" (selectionChange)="loadStudentList()"
                    formControlName="classCode">
                    <input type="text" class="form-control  form-control-sm" #filterClassName>
                    <div *ngIf="allClassList | async as postdata ">
                        <mat-option *ngFor="let data of postdata | filterData: filterClassName.value : 'className'"
                            [value]="data.classCode">
                            {{data.className}}
                        </mat-option>
                    </div>
                </mat-select>
                <div class="invalid-feedback">{{validationMsg.getErrorMessage(feesFormControll.classCode,"Standard")}}
                </div>
            </div>
            <!-- end::Standard -->

            <!-- begin::Student Name -->
            <div class="form-group">
                <label class="form-label required">Select Student</label>
                <mat-select class="form-control form-control-sm" formControlName="registrationNo">
                    <input type="text" class="form-control  form-control-sm" #filterStudent>
                    <div *ngIf="studentList | async as postdata ">
                        <mat-option *ngFor="let data of postdata.data | filterData: filterStudent.value : 'studentName'"
                            [value]="data.registrationNo">
                            {{data.studentName}}
                        </mat-option>
                    </div>
                </mat-select>
                <div class="invalid-feedback">{{validationMsg.getErrorMessage(feesFormControll.registrationNo,"Student Name")}}</div>
            </div>
            <!-- end::Student Name -->

            <!-- begin::Buttons -->
            <div class="grid-button form-group pt-4">
                <!-- <button class="btn btn-sm btn-success mx-3" [disabled]="!formgroup.valid" (click)="getFeesDetails()">Get Fees -->
                <button class="btn btn-sm btn-success mx-3" [disabled]="!(feesFormControll.registrationNo.value && feesFormControll.classCode.value && feesFormControll.academicYearCode.value)" (click)="getFeesDetails()">Get Fees
                    Details</button>
                <button class="btn btn-sm btn-danger" (click)="resetForm()">Reset</button>
            </div>
            <!-- end::Buttons -->
            </div>
    
    <!--<div class="card-body">
        <p></p>
      </div>-->



    <!--<h1>Fee Payment - Subsequent</h1>-->
<div *ngIf="registrationModel | async as registartion">
    <div *ngIf="registartion.data[0].studentFeesStructure[0] as studentFeesStructure ">
    <!-- Fee Structure Card -->
    <div class="card mb-4">
        <div class="card-header d-flex align-items-center justify-content-between">
            <span>Fee Structure of <b>Shubhanshu Maurya -</b></span>
            <button class="btn btn-sm btn-info">Please Click if you want to Convert To Lumpsum</button>
        </div>
        <!--<div class="card-body">
        <p></p>
      </div>-->
    </div>

    <!-- Previous Amount After Discount Table -->
    <div class="mb-4">
        <h2>Annual + Registration Fee: {{studentFeesStructure.annualFees + studentFeesStructure.registrationFees}}, Pending Fee: 0</h2>
        <table class="table show-previous-amount-table">
            <thead>
                <tr>
                    <th scope="col">S.No</th>
                    <th scope="col">Due Date</th>
                    <th scope="col">Total Amount</th>
                    <th scope="col">Previous Discount</th>
                    <th scope="col">Enter Discount</th>
                    <th scope="col">Reason for Discount</th>
                    <th scope="col">Amount After Discount</th>
                    <th scope="col">Amount Paid</th>
                    <th scope="col">Net Payable</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>10/04/2023</td>
                    <td>{{studentFeesStructure.annualFees + studentFeesStructure.registrationFees}}</td>
                    <td><input type="text" readonly value="{{studentFeesStructure.discountAmount}}" class="form-control"></td>
                    <td><input type="text" class="form-control"></td>
                    <td><input type="text" class="form-control"></td>
                    <td>{{(studentFeesStructure.annualFees + studentFeesStructure.registrationFees) - studentFeesStructure.discountAmount}}</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td class="" colspan="7">
                        <h2>Installment (Term Fee: {{(studentFeesStructure.netAmountAfterDiscount-(studentFeesStructure.annualFees + studentFeesStructure.registrationFees))}}, Term Fee Pending Amounts : 12000)</h2>
                    </td>
                </tr>
                <tr *ngFor="let data of studentFeesStructure.studentFeesInstallment; index as i">
                    <td>{{(i+2)}}</td>
                    <td>{{data.installmentDate}}</td>
                    <td>{{data.installmentAmount}}</td>
                    <td><input type="text" readonly value ='0' class="form-control"></td>
                    <td><input type="text" value="{{data.discountAmount}}" class="form-control"></td>
                    <td><input type="text" value="{{data.discountReason}}" class="form-control"></td>
                    <td><input type="text" readonly value="{{data.installmentAmount-data.discountAmount}}" class="form-control"></td>
                    <td>0</td>
                    <td>4000</td>
                </tr>
                
                <tr  class="bg-warning total">
                    <td><strong>Total</strong></td>
                    <td>23300</td>
                    <td>4900</td>
                    <td>Previous Discount </td>
                    <td>0</td>
                    <td>18400</td>
                    <td>999</td>
                    <td>64000</td>
                    <td>12000</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!--Fee Payment-->
    <div class="mb-4">
        <h2>Fee Payment - Please Enter Payment Details Below: (Amount Paid Till Date :6400)</h2>
        <table class="table fee-payment-table">
            <thead>
                <tr>
                    <th scope="col">Amount *</th>
                    <!-- <th scope="col">Discount Reason</th>
                    <th scope="col">Discount</th> -->
                    <th scope="col">Payment Mode *</th>
                    <th scope="col">Payment Date *</th>
                    <th scope="col">Receipt ton be Printed on the name of *</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <input type="text" formControlName="amount" class="form-control" placeholder="Enter Amount" />
                    </td>
                    <!-- <td>
                        <input type="text" name="" class="form-control" placeholder="Discount Reason" />
                    </td>
                    <td>
                        <input type="text" name="" class="form-control" placeholder="Enter Discount" />
                    </td> -->
                    <td>
                        <select class="form-select" formControlName="paymentMode" class="form-control">
                            <option selected>Select Mode</option>
                            <option value="CASH">CASH</option>
                            <option value="ONLINE">ONLINE</option>
                            <option value="CHEQUE">CHEQUE</option>
                        </select>
                    </td>
                    <td>
                        <input type="date" formControlName="paymentDate" class="form-control">
                    </td>
                    <td>
                        <select class="form-select" formControlName="paymentReceivedBy" class="form-control">
                            <option selected>Select Name</option>
                            <option value="1">Shubhanshu Maurya</option>
                            <option value="2">Dinesh Kumar</option>
                        </select>
                </tr>
            </tbody>
        </table>
        <div class="d-flex justify-content-start">
            <button class="btn btn-sm btn-info m-2">Preview Receipt</button>
            <button class="btn btn-sm btn-warning m-2" >Save & Print</button>
            <button class="btn btn-sm btn-success m-2" [disabled]="!formgroup.valid" (click)="save()">Save</button>
        </div>
    </div>
</div>
</div> 


</div>
</form>
</div>